# Оптимизатор таймлайна для DaVinci Resolve

Этот инструмент предназначен для оптимизации XML-файлов таймлайна из DaVinci Resolve. Он "схлопывает" клипы с нескольких дорожек в минимально возможное количество, делая ваш таймлайн более чистым и организованным. Это особенно полезно после синхронизации мультикамерных проектов, когда клипы оказываются разбросанными по множеству дорожек.

![Скриншот программы](https://i.imgur.com/SHjkNMo.png) 
*(Примечание: добавьте сюда скриншот интерфейса программы)*

## Основные возможности

*   **Оптимизация видео и аудио:** Позволяет независимо обрабатывать видео и аудио дорожки.
*   **Уменьшение количества дорожек:** Эффективно перераспределяет непересекающиеся клипы на меньшее количество дорожек.
*   **Простой графический интерфейс:** Интуитивно понятный интерфейс, созданный с помощью `tkinter`.
*   **Индикатор прогресса:** Наглядно показывает ход выполнения операции.
*   **Безопасность:** Создает новый оптимизированный XML-файл, не изменяя исходный.

## Требования

*   **Python 3.x**

Никаких внешних библиотек не требуется, так как скрипт использует только стандартные модули Python (`tkinter`, `xml`, `os`).

## Как использовать

1.  **Экспортируйте таймлайн из DaVinci Resolve:**
    *   Перейдите на вкладку "Edit" или "Cut".
    *   В меню выберите `File` -> `Export` -> `Timeline...`.
    *   Сохраните файл в формате `.xml`. Файлы FCP 7 XML v5

2.  **Запустите программу:**
    *   Запустите файл `main.py` с помощью Python:
      ```bash
      python main.py
      ```
    *   Или запустите скомпилированный `.exe` файл.

3.  **Выберите файлы:**
    *   Нажмите кнопку **"Обзор..."** и выберите экспортированный `.xml` файл.
    *   Путь для сохранения оптимизированного файла будет предложен автоматически (с суффиксом `_optimized`). При необходимости его можно изменить с помощью кнопки **"Сохранить как..."**.

4.  **Выберите опции:**
    *   Отметьте галочками, какие дорожки вы хотите оптимизировать: "Видео дорожки" и/или "Аудио дорожки".

5.  **Запустите оптимизацию:**
    *   Нажмите большую зеленую кнопку **"Оптимизировать таймлайн"**.
    *   Дождитесь завершения процесса, наблюдая за индикатором прогресса.

6.  **Импортируйте результат в DaVinci Resolve:**
    *   После появления сообщения об успешном завершении, вернитесь в DaVinci Resolve.
    *   Импортируйте новый, оптимизированный `.xml` файл (`File` -> `Import` -> `Timeline...`).
    *   В вашем Media Pool появится новый таймлайн с упорядоченными дорожками.

## Как это работает

Алгоритм работает следующим образом:
1.  Считывает все видео- или аудиоклипы из XML-файла, запоминая их время начала и окончания.
2.  Сортирует все клипы по времени их начала.
3.  Создает пустые "оптимизированные" дорожки.
4.  Последовательно берет каждый клип и пытается поместить его на первую доступную дорожку, где он не пересекается с уже размещенными клипами.
5.  Если ни одна из существующих дорожек не подходит, создается новая.
6.  После размещения всех клипов старые дорожки удаляются, а на их место записываются новые, оптимизированные.

## Сборка в исполняемый файл (.exe)

Если вы хотите создать один исполняемый файл для Windows, вы можете использовать `pyinstaller`.

1.  Установите `pyinstaller`:
    ```bash
    pip install pyinstaller
    ```

2.  Выполните команду в терминале, находясь в папке с файлом `main.py`:
    ```bash
    pyinstaller --onefile --windowed --name DaVinciSynchroMerger main.py
    ```
    *   `--onefile`: Создает один исполняемый файл.
    *   `--windowed`: Убирает консольное окно при запуске GUI-приложения.
    *   `--name`: Задает имя для вашего приложения.

Готовый файл появится в папке `dist`.
